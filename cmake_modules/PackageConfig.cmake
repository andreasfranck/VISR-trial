# Package generation configuraton

SET( CPACK_DEBIAN_PACKAGE_MAINTAINER "Andreas Franck A.Franck@soton.ac.uk" )
SET( CPACK_PACKAGE_NAME "VISR" )
SET( CPACK_PACKAGE_VENDOR "ISVR")

IF( WIN32 )
SET( CPACK_GENERATOR "NSIS" )
SET(CPACK_NSIS_INSTALL_ROOT "$PROGRAMFILES64")
GET_FILENAME_COMPONENT( PORTAUDIO_LIBRARY_DIR ${PORTAUDIO_LIBRARY} DIRECTORY )
INSTALL( FILES ${PORTAUDIO_LIBRARY_DIR}/portaudio_x64.dll DESTINATION bin )
IF(BUILD_USE_FFTW)
  GET_FILENAME_COMPONENT( FFTW_LIBRARY_DIR ${FFTW3_LIBRARY} DIRECTORY )
  INSTALL( FILES ${FFTW_LIBRARY_DIR}/libfftw3-3.dll DESTINATION bin )
  INSTALL( FILES ${FFTW_LIBRARY_DIR}/libfftw3f-3.dll DESTINATION bin )
ENDIF(BUILD_USE_FFTW)
# Boost
IF( NOT Boost_USE_STATIC_LIBS )
  GET_FILENAME_COMPONENT( BOOST_CHRONO_LIBRARY_BASENAME ${Boost_CHRONO_LIBRARY_RELEASE} NAME_WE )
  GET_FILENAME_COMPONENT( BOOST_DATE_TIME_LIBRARY_BASENAME ${Boost_DATE_TIME_LIBRARY_RELEASE} NAME_WE )
  GET_FILENAME_COMPONENT( BOOST_FILESYSTEM_LIBRARY_BASENAME ${Boost_FILESYSTEM_LIBRARY_RELEASE} NAME_WE )
  GET_FILENAME_COMPONENT( BOOST_PROGRAM_OPTIONS_LIBRARY_BASENAME ${Boost_PROGRAM_OPTIONS_LIBRARY_RELEASE} NAME_WE )
  GET_FILENAME_COMPONENT( BOOST_SYSTEM_LIBRARY_BASENAME ${Boost_SYSTEM_LIBRARY_RELEASE} NAME_WE )
  GET_FILENAME_COMPONENT( BOOST_THREAD_LIBRARY_BASENAME ${Boost_THREAD_LIBRARY_RELEASE} NAME_WE )
  INSTALL( FILES ${Boost_LIBRARY_DIR}/${BOOST_CHRONO_LIBRARY_BASENAME}.dll DESTINATION bin )
  INSTALL( FILES ${Boost_LIBRARY_DIR}/${BOOST_DATE_TIME_LIBRARY_BASENAME}.dll DESTINATION bin )
  INSTALL( FILES ${Boost_LIBRARY_DIR}/${BOOST_FILESYSTEM_LIBRARY_BASENAME}.dll DESTINATION bin )
  INSTALL( FILES ${Boost_LIBRARY_DIR}/${BOOST_PROGRAM_OPTIONS_LIBRARY_BASENAME}.dll DESTINATION bin )
  INSTALL( FILES ${Boost_LIBRARY_DIR}/${BOOST_SYSTEM_LIBRARY_BASENAME}.dll DESTINATION bin )
  INSTALL( FILES ${Boost_LIBRARY_DIR}/${BOOST_THREAD_LIBRARY_BASENAME}.dll DESTINATION bin )
ENDIF( NOT Boost_USE_STATIC_LIBS )
ENDIF( WIN32 )

IF( VISR_SYSTEM_NAME MATCHES "Linux" )
  SET( CPACK_GENERATOR DEB TBZ2 )
  SET( CPACK_DEBIAN_HOMEPAGE "http://www.s3a-spatialaudio.org" )
  SET( CPACK_DEBIAN_PACKAGE_SHLIBDEPS ON)
ENDIF(VISR_SYSTEM_NAME MATCHES "Linux")

IF( VISR_SYSTEM_NAME MATCHES "MacOS" )
  SET( CPACK_GENERATOR "Bundle" )
  SET( CPACK_BUNDLE_NAME "VISR" )
  IF( NOT Boost_USE_STATIC_LIBS )
    INSTALL( FILES ${PORTAUDIO_LIBRARIES} DESTINATION bin)
    INSTALL( FILES ${Boost_FILESYSTEM_LIBRARY} DESTINATION bin )
    INSTALL( FILES ${Boost_SYSTEM_LIBRARY} DESTINATION bin )
    INSTALL( FILES ${Boost_THREAD_LIBRARY} DESTINATION bin )
    INSTALL( FILES ${Boost_PROGRAM_OPTIONS_LIBRARY} DESTINATION bin )
    INSTALL( FILES ${CMAKE_THREAD_LIBS_INIT} DESTINATION bin )
  ENDIF( NOT Boost_USE_STATIC_LIBS )
ENDIF( VISR_SYSTEM_NAME MATCHES "MacOS" )

INSTALL( DIRECTORY config DESTINATION share/visr )
INSTALL( FILES ${CMAKE_SOURCE_DIR}/licence.txt DESTINATION share/visr )
SET( CPACK_RESOURCE_FILE_LICENSE ${CMAKE_SOURCE_DIR}/licence.txt )

INCLUDE( CPack )
